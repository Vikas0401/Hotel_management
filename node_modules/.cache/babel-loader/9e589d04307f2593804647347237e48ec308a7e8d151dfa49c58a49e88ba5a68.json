{"ast":null,"code":"// Bill History Service for managing saved bills\nimport { getCurrentUser, getCurrentHotelId } from './authService';\n\n// Save bill to history\nexport const saveBillToHistory = billData => {\n  const hotelId = getCurrentHotelId();\n  const user = getCurrentUser();\n  if (!hotelId || !billData) return false;\n  const billRecord = {\n    id: 'BILL_' + Date.now(),\n    billNumber: billData.billNumber,\n    date: billData.date,\n    time: billData.time,\n    customerInfo: billData.customerInfo,\n    items: billData.items,\n    subtotal: billData.subtotal,\n    tax: billData.tax,\n    total: billData.total,\n    paymentInfo: billData.paymentInfo || {\n      jama: 0,\n      baki: billData.total || 0\n    },\n    hotelName: user === null || user === void 0 ? void 0 : user.hotelName,\n    savedAt: new Date().toISOString(),\n    savedBy: user === null || user === void 0 ? void 0 : user.username\n  };\n\n  // Get existing bills for this hotel\n  const existingBills = getBillHistory();\n\n  // Add new bill to the beginning of the array\n  const updatedBills = [billRecord, ...existingBills];\n\n  // Save to localStorage\n  localStorage.setItem(`bill_history_${hotelId}`, JSON.stringify(updatedBills));\n  return billRecord.id;\n};\n\n// Get bill history for current hotel\nexport const getBillHistory = () => {\n  const hotelId = getCurrentHotelId();\n  if (!hotelId) return [];\n  const bills = localStorage.getItem(`bill_history_${hotelId}`);\n  return bills ? JSON.parse(bills) : [];\n};\n\n// Get bill by ID\nexport const getBillById = billId => {\n  const bills = getBillHistory();\n  return bills.find(bill => bill.id === billId);\n};\n\n// Delete bill from history\nexport const deleteBillFromHistory = billId => {\n  const hotelId = getCurrentHotelId();\n  if (!hotelId) return false;\n  const bills = getBillHistory();\n  const updatedBills = bills.filter(bill => bill.id !== billId);\n  localStorage.setItem(`bill_history_${hotelId}`, JSON.stringify(updatedBills));\n  return true;\n};\n\n// Update payment information for a specific bill\nexport const updateBillPayment = (billId, paymentInfo) => {\n  const hotelId = getCurrentHotelId();\n  if (!hotelId) return false;\n  const bills = getBillHistory();\n  const updatedBills = bills.map(bill => {\n    if (bill.id === billId) {\n      return {\n        ...bill,\n        paymentInfo: {\n          jama: paymentInfo.jama,\n          baki: paymentInfo.baki\n        },\n        lastUpdated: new Date().toISOString()\n      };\n    }\n    return bill;\n  });\n  localStorage.setItem(`bill_history_${hotelId}`, JSON.stringify(updatedBills));\n  return true;\n};\n\n// Filter bills by customer name and date range\nexport const filterBills = filters => {\n  const bills = getBillHistory();\n  return bills.filter(bill => {\n    // Filter by customer name\n    if (filters.customerName) {\n      var _bill$customerInfo, _bill$customerInfo$na;\n      const customerName = ((_bill$customerInfo = bill.customerInfo) === null || _bill$customerInfo === void 0 ? void 0 : (_bill$customerInfo$na = _bill$customerInfo.name) === null || _bill$customerInfo$na === void 0 ? void 0 : _bill$customerInfo$na.toLowerCase()) || '';\n      const searchName = filters.customerName.toLowerCase();\n      if (!customerName.includes(searchName)) {\n        return false;\n      }\n    }\n\n    // Filter by date range\n    if (filters.startDate) {\n      const billDate = new Date(bill.date);\n      const startDate = new Date(filters.startDate);\n      if (billDate < startDate) {\n        return false;\n      }\n    }\n    if (filters.endDate) {\n      const billDate = new Date(bill.date);\n      const endDate = new Date(filters.endDate);\n      if (billDate > endDate) {\n        return false;\n      }\n    }\n    return true;\n  });\n};\n\n// Get bill statistics\nexport const getBillStatistics = () => {\n  const bills = getBillHistory();\n  const totalBills = bills.length;\n  const totalRevenue = bills.reduce((sum, bill) => sum + bill.total, 0);\n  const averageBillAmount = totalBills > 0 ? totalRevenue / totalBills : 0;\n\n  // Get today's bills\n  const today = new Date().toLocaleDateString();\n  const todaysBills = bills.filter(bill => bill.date === today);\n  const todaysRevenue = todaysBills.reduce((sum, bill) => sum + bill.total, 0);\n  return {\n    totalBills,\n    totalRevenue,\n    averageBillAmount,\n    todaysBills: todaysBills.length,\n    todaysRevenue\n  };\n};\n\n// Export bills to JSON (for backup/download)\nexport const exportBillHistory = () => {\n  const bills = getBillHistory();\n  const user = getCurrentUser();\n  const exportData = {\n    hotelName: user === null || user === void 0 ? void 0 : user.hotelName,\n    exportDate: new Date().toISOString(),\n    totalBills: bills.length,\n    bills: bills\n  };\n  return JSON.stringify(exportData, null, 2);\n};","map":{"version":3,"names":["getCurrentUser","getCurrentHotelId","saveBillToHistory","billData","hotelId","user","billRecord","id","Date","now","billNumber","date","time","customerInfo","items","subtotal","tax","total","paymentInfo","jama","baki","hotelName","savedAt","toISOString","savedBy","username","existingBills","getBillHistory","updatedBills","localStorage","setItem","JSON","stringify","bills","getItem","parse","getBillById","billId","find","bill","deleteBillFromHistory","filter","updateBillPayment","map","lastUpdated","filterBills","filters","customerName","_bill$customerInfo","_bill$customerInfo$na","name","toLowerCase","searchName","includes","startDate","billDate","endDate","getBillStatistics","totalBills","length","totalRevenue","reduce","sum","averageBillAmount","today","toLocaleDateString","todaysBills","todaysRevenue","exportBillHistory","exportData","exportDate"],"sources":["C:/Users/vkale/Documents/Vikas/Hotel_managenment/Hotel_management/src/services/billHistoryService.js"],"sourcesContent":["// Bill History Service for managing saved bills\r\nimport { getCurrentUser, getCurrentHotelId } from './authService';\r\n\r\n// Save bill to history\r\nexport const saveBillToHistory = (billData) => {\r\n    const hotelId = getCurrentHotelId();\r\n    const user = getCurrentUser();\r\n    \r\n    if (!hotelId || !billData) return false;\r\n    \r\n    const billRecord = {\r\n        id: 'BILL_' + Date.now(),\r\n        billNumber: billData.billNumber,\r\n        date: billData.date,\r\n        time: billData.time,\r\n        customerInfo: billData.customerInfo,\r\n        items: billData.items,\r\n        subtotal: billData.subtotal,\r\n        tax: billData.tax,\r\n        total: billData.total,\r\n        paymentInfo: billData.paymentInfo || { jama: 0, baki: billData.total || 0 },\r\n        hotelName: user?.hotelName,\r\n        savedAt: new Date().toISOString(),\r\n        savedBy: user?.username\r\n    };\r\n    \r\n    // Get existing bills for this hotel\r\n    const existingBills = getBillHistory();\r\n    \r\n    // Add new bill to the beginning of the array\r\n    const updatedBills = [billRecord, ...existingBills];\r\n    \r\n    // Save to localStorage\r\n    localStorage.setItem(`bill_history_${hotelId}`, JSON.stringify(updatedBills));\r\n    \r\n    return billRecord.id;\r\n};\r\n\r\n// Get bill history for current hotel\r\nexport const getBillHistory = () => {\r\n    const hotelId = getCurrentHotelId();\r\n    if (!hotelId) return [];\r\n    \r\n    const bills = localStorage.getItem(`bill_history_${hotelId}`);\r\n    return bills ? JSON.parse(bills) : [];\r\n};\r\n\r\n// Get bill by ID\r\nexport const getBillById = (billId) => {\r\n    const bills = getBillHistory();\r\n    return bills.find(bill => bill.id === billId);\r\n};\r\n\r\n// Delete bill from history\r\nexport const deleteBillFromHistory = (billId) => {\r\n    const hotelId = getCurrentHotelId();\r\n    if (!hotelId) return false;\r\n    \r\n    const bills = getBillHistory();\r\n    const updatedBills = bills.filter(bill => bill.id !== billId);\r\n    \r\n    localStorage.setItem(`bill_history_${hotelId}`, JSON.stringify(updatedBills));\r\n    return true;\r\n};\r\n\r\n// Update payment information for a specific bill\r\nexport const updateBillPayment = (billId, paymentInfo) => {\r\n    const hotelId = getCurrentHotelId();\r\n    if (!hotelId) return false;\r\n    \r\n    const bills = getBillHistory();\r\n    const updatedBills = bills.map(bill => {\r\n        if (bill.id === billId) {\r\n            return {\r\n                ...bill,\r\n                paymentInfo: {\r\n                    jama: paymentInfo.jama,\r\n                    baki: paymentInfo.baki\r\n                },\r\n                lastUpdated: new Date().toISOString()\r\n            };\r\n        }\r\n        return bill;\r\n    });\r\n    \r\n    localStorage.setItem(`bill_history_${hotelId}`, JSON.stringify(updatedBills));\r\n    return true;\r\n};\r\n\r\n// Filter bills by customer name and date range\r\nexport const filterBills = (filters) => {\r\n    const bills = getBillHistory();\r\n    \r\n    return bills.filter(bill => {\r\n        // Filter by customer name\r\n        if (filters.customerName) {\r\n            const customerName = bill.customerInfo?.name?.toLowerCase() || '';\r\n            const searchName = filters.customerName.toLowerCase();\r\n            if (!customerName.includes(searchName)) {\r\n                return false;\r\n            }\r\n        }\r\n        \r\n        // Filter by date range\r\n        if (filters.startDate) {\r\n            const billDate = new Date(bill.date);\r\n            const startDate = new Date(filters.startDate);\r\n            if (billDate < startDate) {\r\n                return false;\r\n            }\r\n        }\r\n        \r\n        if (filters.endDate) {\r\n            const billDate = new Date(bill.date);\r\n            const endDate = new Date(filters.endDate);\r\n            if (billDate > endDate) {\r\n                return false;\r\n            }\r\n        }\r\n        \r\n        return true;\r\n    });\r\n};\r\n\r\n// Get bill statistics\r\nexport const getBillStatistics = () => {\r\n    const bills = getBillHistory();\r\n    \r\n    const totalBills = bills.length;\r\n    const totalRevenue = bills.reduce((sum, bill) => sum + bill.total, 0);\r\n    const averageBillAmount = totalBills > 0 ? totalRevenue / totalBills : 0;\r\n    \r\n    // Get today's bills\r\n    const today = new Date().toLocaleDateString();\r\n    const todaysBills = bills.filter(bill => bill.date === today);\r\n    const todaysRevenue = todaysBills.reduce((sum, bill) => sum + bill.total, 0);\r\n    \r\n    return {\r\n        totalBills,\r\n        totalRevenue,\r\n        averageBillAmount,\r\n        todaysBills: todaysBills.length,\r\n        todaysRevenue\r\n    };\r\n};\r\n\r\n// Export bills to JSON (for backup/download)\r\nexport const exportBillHistory = () => {\r\n    const bills = getBillHistory();\r\n    const user = getCurrentUser();\r\n    \r\n    const exportData = {\r\n        hotelName: user?.hotelName,\r\n        exportDate: new Date().toISOString(),\r\n        totalBills: bills.length,\r\n        bills: bills\r\n    };\r\n    \r\n    return JSON.stringify(exportData, null, 2);\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
"use strict";(self.webpackChunkhotel_website=self.webpackChunkhotel_website||[]).push([[875],{7875:(t,e,o)=>{o.d(e,{autoExportMonthlyReport:()=>r});var a=o(8816),n=o(1389);o(4857);const l=()=>{const t=(0,a.dh)();if(console.log("getBillHistory called with hotelId:",t),!t)return console.log("No hotelId found, returning empty array"),[];if("sample"===t)return[{id:"BILL_SAMPLE_001",billNumber:"B123456",date:"10/10/2025",time:"2:30:45 PM",customerInfo:{name:"Demo Customer 1",tableNumber:"T5",phoneNumber:"9876543210"},items:[{code:"101",name:"Sample Special Thali",rate:250,quantity:2},{code:"201",name:"Vada Pav",rate:30,quantity:3},{code:"601",name:"Masala Tea",rate:25,quantity:2}],subtotal:590,tax:0,total:590,paymentInfo:{jama:600,baki:0},hotelName:"Sample Hotel",savedAt:"2025-10-10T14:30:45.000Z",savedBy:"sample_user"},{id:"BILL_SAMPLE_002",billNumber:"B123457",date:"11/10/2025",time:"7:15:20 PM",customerInfo:{name:"Demo Customer 2",tableNumber:"T3",phoneNumber:"9123456789"},items:[{code:"102",name:"Mini Thali",rate:150,quantity:1},{code:"301",name:"Veg Pulao",rate:160,quantity:1},{code:"602",name:"Buttermilk",rate:35,quantity:2}],subtotal:380,tax:0,total:380,paymentInfo:{jama:380,baki:0},hotelName:"Sample Hotel",savedAt:"2025-10-11T19:15:20.000Z",savedBy:"sample_user"},{id:"BILL_SAMPLE_003",billNumber:"B123458",date:"12/10/2025",time:"1:45:10 PM",customerInfo:{name:"Demo Customer 3",tableNumber:"T7",phoneNumber:"9876512345"},items:[{code:"202",name:"Bhaji Plate",rate:80,quantity:2},{code:"401",name:"Roti",rate:18,quantity:4},{code:"501",name:"Dal Tadka",rate:120,quantity:1}],subtotal:292,tax:0,total:292,paymentInfo:{jama:300,baki:0},hotelName:"Sample Hotel",savedAt:"2025-10-12T13:45:10.000Z",savedBy:"sample_user"}];const e="bill_history_".concat(t),o=localStorage.getItem(e);console.log("Retrieved from localStorage with key:",e),console.log("Raw data from localStorage:",o);const n=o?JSON.parse(o):[];return console.log("Parsed bills:",n),console.log("Number of bills found:",n.length),n},r=()=>{const t=new Date;if(1===t.getDate()){const e=new Date(t.getFullYear(),t.getMonth()-1,1),o=e.toISOString().split("T")[0],a=new Date(t.getFullYear(),t.getMonth(),0).toISOString().split("T")[0],n=l().filter(t=>{const e=new Date(t.date.split("/").reverse().join("-"));return e>=new Date(o)&&e<=new Date(a)});if(n.length>0){const t=i(n,e),o=e.toLocaleString("default",{month:"long",year:"numeric"}),a="Monthly_Report_".concat(o.replace(" ","_"),".pdf");return t.save(a),console.log("Auto-exported monthly report: ".concat(a)),!0}}return!1},i=(t,e)=>{const o=(0,a.HW)(),l=new n.uE;l.setFontSize(16),l.setFont(void 0,"bold");const r="\u0939\u0949\u091f\u0947\u0932 \u092e\u093e\u0924\u094b\u0936\u094d\u0930\u0940"===(null===o||void 0===o?void 0:o.hotelName)?"Hotel Matoshree":"\u0939\u0949\u091f\u0947\u0932 \u0917\u0941\u0930\u0941\u0915\u0943\u092a\u093e"===(null===o||void 0===o?void 0:o.hotelName)?"Hotel Gurukrupa":(null===o||void 0===o?void 0:o.hotelName)||"Hotel",i=e.toLocaleString("default",{month:"long",year:"numeric"});return l.text("".concat(r," - Monthly Report"),20,20),l.setFontSize(12),l.text("Month: ".concat(i),20,35),l.text("Generated: ".concat((new Date).toLocaleDateString()),20,45),l.text("Total Bills: ".concat(t.length),20,55),s(l,t,65)},s=(t,e,o)=>{let a=o;t.setFont(void 0,"bold"),t.setFontSize(9),t.text("Sr.",15,a),t.text("Bill No.",25,a),t.text("Date",55,a),t.text("Customer",85,a),t.text("Type",120,a),t.text("Total",140,a),t.text("Received",165,a),t.text("Balance",190,a),a+=5,t.line(15,a,210,a),a+=5,t.setFont(void 0,"normal"),t.setFontSize(8),e.forEach((e,o)=>{var n,l,r,i;a>270&&(t.addPage(),a=20,t.setFont(void 0,"bold"),t.setFontSize(9),t.text("Sr.",15,a),t.text("Bill No.",25,a),t.text("Date",55,a),t.text("Customer",85,a),t.text("Type",120,a),t.text("Total",140,a),t.text("Received",165,a),t.text("Balance",190,a),a+=5,t.line(15,a,210,a),a+=5,t.setFont(void 0,"normal"),t.setFontSize(8));const s=((null===(n=e.customerInfo)||void 0===n?void 0:n.name)||"Walk-in").substring(0,12),m=null!==(l=e.customerInfo)&&void 0!==l&&l.tableNumber&&"-"!==e.customerInfo.tableNumber?"Table":"Parcel",c=(null===(r=e.paymentInfo)||void 0===r?void 0:r.jama)||0,u=(null===(i=e.paymentInfo)||void 0===i?void 0:i.baki)||e.total||0;t.text((o+1).toString(),15,a),t.text(e.billNumber,25,a),t.text(e.date,55,a),t.text(s,85,a),t.text(m,120,a),t.text("".concat((e.total||0).toFixed(0)),140,a),t.text("".concat(c.toFixed(0)),165,a),t.text("".concat(u.toFixed(0)),190,a),a+=5}),a+=3,t.line(140,a,210,a),a+=5;const n=e.reduce((t,e)=>t+(e.total||0),0),l=e.reduce((t,e)=>{var o;return t+((null===(o=e.paymentInfo)||void 0===o?void 0:o.jama)||0)},0),r=e.reduce((t,e)=>{var o;return t+((null===(o=e.paymentInfo)||void 0===o?void 0:o.baki)||e.total||0)},0);return t.setFont(void 0,"bold"),t.setFontSize(9),t.text("TOTALS:",110,a),t.text("Rs.".concat(n.toFixed(0)),140,a),t.text("Rs.".concat(l.toFixed(0)),165,a),t.text("Rs.".concat(r.toFixed(0)),190,a),t}}}]);
//# sourceMappingURL=875.e6b2aa1b.chunk.js.map
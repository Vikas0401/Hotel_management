{"version":3,"file":"static/js/875.fa75446a.chunk.js","mappings":"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","sources":["services/billHistoryService.js"],"sourcesContent":["// Bill History Service for managing saved bills\nimport { getCurrentUser, getCurrentHotelId } from './authService';\nimport { jsPDF } from 'jspdf';\nimport 'jspdf-autotable';\n\n// Sample bill data for demo purposes\nconst getSampleBillData = () => {\n    return [\n        {\n            id: 'BILL_SAMPLE_001',\n            billNumber: 'B123456',\n            date: '10/10/2025',\n            time: '2:30:45 PM',\n            customerInfo: {\n                name: 'Demo Customer 1',\n                tableNumber: 'T5',\n                phoneNumber: '9876543210'\n            },\n            items: [\n                { code: '101', name: 'Sample Special Thali', rate: 250, quantity: 2 },\n                { code: '201', name: 'Vada Pav', rate: 30, quantity: 3 },\n                { code: '601', name: 'Masala Tea', rate: 25, quantity: 2 }\n            ],\n            subtotal: 590,\n            tax: 0,\n            total: 590,\n            paymentInfo: { jama: 600, baki: 0 },\n            hotelName: 'Sample Hotel',\n            savedAt: '2025-10-10T14:30:45.000Z',\n            savedBy: 'sample_user'\n        },\n        {\n            id: 'BILL_SAMPLE_002',\n            billNumber: 'B123457',\n            date: '11/10/2025',\n            time: '7:15:20 PM',\n            customerInfo: {\n                name: 'Demo Customer 2',\n                tableNumber: 'T3',\n                phoneNumber: '9123456789'\n            },\n            items: [\n                { code: '102', name: 'Mini Thali', rate: 150, quantity: 1 },\n                { code: '301', name: 'Veg Pulao', rate: 160, quantity: 1 },\n                { code: '602', name: 'Buttermilk', rate: 35, quantity: 2 }\n            ],\n            subtotal: 380,\n            tax: 0,\n            total: 380,\n            paymentInfo: { jama: 380, baki: 0 },\n            hotelName: 'Sample Hotel',\n            savedAt: '2025-10-11T19:15:20.000Z',\n            savedBy: 'sample_user'\n        },\n        {\n            id: 'BILL_SAMPLE_003',\n            billNumber: 'B123458',\n            date: '12/10/2025',\n            time: '1:45:10 PM',\n            customerInfo: {\n                name: 'Demo Customer 3',\n                tableNumber: 'T7',\n                phoneNumber: '9876512345'\n            },\n            items: [\n                { code: '202', name: 'Bhaji Plate', rate: 80, quantity: 2 },\n                { code: '401', name: 'Roti', rate: 18, quantity: 4 },\n                { code: '501', name: 'Dal Tadka', rate: 120, quantity: 1 }\n            ],\n            subtotal: 292,\n            tax: 0,\n            total: 292,\n            paymentInfo: { jama: 300, baki: 0 },\n            hotelName: 'Sample Hotel',\n            savedAt: '2025-10-12T13:45:10.000Z',\n            savedBy: 'sample_user'\n        }\n    ];\n};\n\n// Save bill to history\nexport const saveBillToHistory = (billData) => {\n    console.log('saveBillToHistory called with:', billData);\n    \n    const hotelId = getCurrentHotelId();\n    const user = getCurrentUser();\n    \n    console.log('Hotel ID:', hotelId);\n    console.log('User:', user);\n    \n    // Return fake success for sample hotel (read-only mode)\n    if (hotelId === 'sample') {\n        console.log('Sample hotel detected - returning fake success');\n        return 'BILL_SAMPLE_DEMO';\n    }\n    \n    if (!hotelId || !billData) {\n        console.log('Missing hotelId or billData:', { hotelId, billData });\n        return false;\n    }\n    \n    const billRecord = {\n        id: 'BILL_' + Date.now(),\n        billNumber: billData.billNumber,\n        date: billData.date,\n        time: billData.time,\n        customerInfo: billData.customerInfo,\n        items: billData.items,\n        subtotal: billData.subtotal,\n        tax: billData.tax,\n        total: billData.total,\n        paymentInfo: billData.paymentInfo || { jama: 0, baki: billData.total || 0 },\n        hotelName: user?.hotelName,\n        savedAt: new Date().toISOString(),\n        savedBy: user?.username\n    };\n    \n    console.log('Bill record created:', billRecord);\n    \n    // Get existing bills for this hotel\n    const existingBills = getBillHistory();\n    console.log('Existing bills:', existingBills);\n    \n    // Add new bill to the beginning of the array\n    const updatedBills = [billRecord, ...existingBills];\n    \n    // Save to localStorage\n    const storageKey = `bill_history_${hotelId}`;\n    localStorage.setItem(storageKey, JSON.stringify(updatedBills));\n    console.log('Saved to localStorage with key:', storageKey);\n    console.log('Updated bills count:', updatedBills.length);\n    \n    return billRecord.id;\n};\n\n// Get bill history for current hotel\nexport const getBillHistory = () => {\n    const hotelId = getCurrentHotelId();\n    console.log('getBillHistory called with hotelId:', hotelId);\n    \n    if (!hotelId) {\n        console.log('No hotelId found, returning empty array');\n        return [];\n    }\n    \n    // Return sample data for sample hotel\n    if (hotelId === 'sample') {\n        return getSampleBillData();\n    }\n    \n    const storageKey = `bill_history_${hotelId}`;\n    const bills = localStorage.getItem(storageKey);\n    console.log('Retrieved from localStorage with key:', storageKey);\n    console.log('Raw data from localStorage:', bills);\n    \n    const parsedBills = bills ? JSON.parse(bills) : [];\n    console.log('Parsed bills:', parsedBills);\n    console.log('Number of bills found:', parsedBills.length);\n    \n    return parsedBills;\n};\n\n// Get bill by ID\nexport const getBillById = (billId) => {\n    const bills = getBillHistory();\n    return bills.find(bill => bill.id === billId);\n};\n\n// Update bill payment information\nexport const updateBillPayment = (billId, paymentInfo) => {\n    const bills = getBillHistory();\n    const updatedBills = bills.map(bill => {\n        if (bill.id === billId) {\n            return {\n                ...bill,\n                paymentInfo: {\n                    ...bill.paymentInfo,\n                    ...paymentInfo\n                }\n            };\n        }\n        return bill;\n    });\n    \n    const hotelId = getCurrentHotelId();\n    localStorage.setItem(`bill_history_${hotelId}`, JSON.stringify(updatedBills));\n    \n    return true;\n};\n\n// Delete bill from history\nexport const deleteBillFromHistory = (billId) => {\n    const bills = getBillHistory();\n    const updatedBills = bills.filter(bill => bill.id !== billId);\n    \n    const hotelId = getCurrentHotelId();\n    localStorage.setItem(`bill_history_${hotelId}`, JSON.stringify(updatedBills));\n    \n    return true;\n};\n\n// Filter bills by date range or search term\nexport const filterBills = (searchTerm = '', startDate = '', endDate = '') => {\n    const bills = getBillHistory();\n    \n    return bills.filter(bill => {\n        // Ensure searchTerm is a string and handle null/undefined\n        const searchStr = String(searchTerm || '').toLowerCase();\n        \n        const matchesSearch = !searchStr || \n            bill.billNumber?.toLowerCase().includes(searchStr) ||\n            bill.customerInfo?.name?.toLowerCase().includes(searchStr) ||\n            bill.customerInfo?.phoneNumber?.includes(searchTerm);\n            \n        const matchesDateRange = (!startDate || bill.date >= startDate) &&\n            (!endDate || bill.date <= endDate);\n            \n        return matchesSearch && matchesDateRange;\n    });\n};\n\n// Get bill statistics\nexport const getBillStatistics = () => {\n    const bills = getBillHistory();\n    \n    const totalBills = bills.length;\n    const totalRevenue = bills.reduce((sum, bill) => sum + (bill.total || 0), 0);\n    const totalReceived = bills.reduce((sum, bill) => sum + (bill.paymentInfo?.jama || 0), 0);\n    const totalPending = bills.reduce((sum, bill) => sum + (bill.paymentInfo?.baki || 0), 0);\n    \n    // Calculate today's statistics\n    const today = new Date().toLocaleDateString();\n    const todaysBills = bills.filter(bill => {\n        // Check if bill date matches today's date\n        const billDate = new Date(bill.date || bill.savedAt).toLocaleDateString();\n        return billDate === today;\n    });\n    \n    const todaysBillCount = todaysBills.length;\n    const todaysRevenue = todaysBills.reduce((sum, bill) => sum + (bill.total || 0), 0);\n    \n    return {\n        totalBills,\n        totalRevenue,\n        totalReceived,\n        totalPending,\n        todaysBills: todaysBillCount,\n        todaysRevenue: todaysRevenue,\n        averageBillAmount: totalBills > 0 ? totalRevenue / totalBills : 0\n    };\n};\n\n// Export single bill to PDF\nexport const exportSingleBillToPDF = (bill) => {\n    try {\n        console.log('Starting PDF export...');\n        \n        // Show fake save dialog for sample hotel\n        const hotelId = getCurrentHotelId();\n        if (hotelId === 'sample') {\n            // Create a fake file download experience\n            const link = document.createElement('a');\n            link.download = `sample_bill_${bill.billNumber || 'demo'}.pdf`;\n            link.href = 'data:application/pdf;base64,JVBERi0xLjQKJdPr6eEKMSAwIG9iago8PAovVHlwZSAvQ2F0YWxvZwovUGFnZXMgMiAwIFIKPj4KZW5kb2JqCjIgMCBvYmoKPDwKL1R5cGUgL1BhZ2VzCi9LaWRzIFszIDAgUl0KL0NvdW50IDEKL01lZGlhQm94IFswIDAgNTk1IDg0Ml0KPj4KZW5kb2JqCjMgMCBvYmoKPDwKL1R5cGUgL1BhZ2UKL1BhcmVudCAyIDAgUgovUmVzb3VyY2VzIDw8Cj4+Ci9Db250ZW50cyA0IDAgUgo+PgplbmRvYmoKNCAwIG9iago8PAovTGVuZ3RoIDQ0Cj4+CnN0cmVhbQpCVAovRjEgMTIgVGYKNzIgNzIwIFRkCihTYW1wbGUgQmlsbCBQREYpIFRqCkVUCmVuZHN0cmVhbQplbmRvYmoKeHJlZgowIDUKMDAwMDAwMDAwMCA2NTUzNSBmIAowMDAwMDAwMDA5IDAwMDAwIG4gCjAwMDAwMDAwNTggMDAwMDAgbiAKMDAwMDAwMDExNSAwMDAwMCBuIAowMDAwMDAwMTk0IDAwMDAwIG4gCnRyYWlsZXIKPDwKL1NpemUgNQovUm9vdCAxIDAgUgo+PgpzdGFydHhyZWYKMjg5CiUlRU9GCg==';\n            document.body.appendChild(link);\n            link.click();\n            document.body.removeChild(link);\n            \n            console.log('Sample hotel: Fake single bill PDF export completed');\n            return true;\n        }\n        \n        // Validate bill data\n        if (!bill) {\n            throw new Error('No bill data provided');\n        }\n        \n        console.log('Creating jsPDF instance...');\n        // Create new PDF document\n        const doc = new jsPDF();\n        \n        console.log('Adding basic text to PDF...');\n        // Add very basic content\n        doc.text('VK Solutions', 20, 20);\n        doc.text('Hotel Management System', 20, 30);\n        doc.text(`Bill Number: ${bill.billNumber || 'N/A'}`, 20, 50);\n        doc.text(`Date: ${bill.date || 'N/A'}`, 20, 60);\n        doc.text(`Total: Rs. ${(bill.total || 0).toFixed(2)}`, 20, 70);\n        \n        console.log('PDF created successfully');\n        return doc;\n    } catch (error) {\n        console.error('Detailed PDF error:', error);\n        console.error('Error stack:', error.stack);\n        throw error;\n    }\n};\n\n// Export bill history to JSON\nexport const exportBillHistory = () => {\n    const bills = getBillHistory();\n    const user = getCurrentUser();\n    \n    const exportData = {\n        hotelName: user?.hotelName,\n        exportDate: new Date().toISOString(),\n        totalBills: bills.length,\n        bills: bills\n    };\n    \n    return JSON.stringify(exportData, null, 2);\n};\n\n// Auto-export function for monthly reports\nexport const autoExportMonthlyReport = () => {\n    const today = new Date();\n    const isFirstDayOfMonth = today.getDate() === 1;\n    \n    if (isFirstDayOfMonth) {\n        // Get previous month's data\n        const lastMonth = new Date(today.getFullYear(), today.getMonth() - 1, 1);\n        const startDate = lastMonth.toISOString().split('T')[0];\n        const endDate = new Date(today.getFullYear(), today.getMonth(), 0).toISOString().split('T')[0];\n        \n        // Filter bills for last month\n        const allBills = getBillHistory();\n        const monthlyBills = allBills.filter(bill => {\n            const billDate = new Date(bill.date.split('/').reverse().join('-'));\n            return billDate >= new Date(startDate) && billDate <= new Date(endDate);\n        });\n        \n        if (monthlyBills.length > 0) {\n            const doc = generateMonthlyPDF(monthlyBills, lastMonth);\n            const monthName = lastMonth.toLocaleString('default', { month: 'long', year: 'numeric' });\n            const fileName = `Monthly_Report_${monthName.replace(' ', '_')}.pdf`;\n            doc.save(fileName);\n            \n            console.log(`Auto-exported monthly report: ${fileName}`);\n            return true;\n        }\n    }\n    return false;\n};\n\n// Generate PDF for monthly reports\nconst generateMonthlyPDF = (bills, month) => {\n    const user = getCurrentUser();\n    const doc = new jsPDF();\n    \n    // Header\n    doc.setFontSize(16);\n    doc.setFont(undefined, 'bold');\n    const hotelDisplayName = user?.hotelName === 'हॉटेल मातोश्री' ? 'Hotel Matoshree' : \n                           user?.hotelName === 'हॉटेल गुरुकृपा' ? 'Hotel Gurukrupa' : \n                           (user?.hotelName || 'Hotel');\n    \n    const monthYear = month.toLocaleString('default', { month: 'long', year: 'numeric' });\n    doc.text(`${hotelDisplayName} - Monthly Report`, 20, 20);\n    doc.setFontSize(12);\n    doc.text(`Month: ${monthYear}`, 20, 35);\n    doc.text(`Generated: ${new Date().toLocaleDateString()}`, 20, 45);\n    doc.text(`Total Bills: ${bills.length}`, 20, 55);\n    \n    // Use the same table format as regular export\n    return generateBillTable(doc, bills, 65);\n};\n\n// Export bills to PDF (for backup/download)\nexport const exportBillHistoryToPDF = (monthlyFilter = null) => {\n    try {\n        const hotelId = getCurrentHotelId();\n        \n        // Show fake save dialog for sample hotel\n        if (hotelId === 'sample') {\n            // Create a fake file download experience\n            const link = document.createElement('a');\n            link.download = 'sample_bill_history.pdf';\n            link.href = 'data:application/pdf;base64,JVBERi0xLjQKJdPr6eEKMSAwIG9iago8PAovVHlwZSAvQ2F0YWxvZwovUGFnZXMgMiAwIFIKPj4KZW5kb2JqCjIgMCBvYmoKPDwKL1R5cGUgL1BhZ2VzCi9LaWRzIFszIDAgUl0KL0NvdW50IDEKL01lZGlhQm94IFswIDAgNTk1IDg0Ml0KPj4KZW5kb2JqCjMgMCBvYmoKPDwKL1R5cGUgL1BhZ2UKL1BhcmVudCAyIDAgUgovUmVzb3VyY2VzIDw8Cj4+Ci9Db250ZW50cyA0IDAgUgo+PgplbmRvYmoKNCAwIG9iago8PAovTGVuZ3RoIDQ0Cj4+CnN0cmVhbQpCVAovRjEgMTIgVGYKNzIgNzIwIFRkCihTYW1wbGUgUERGKSBUagpFVAplbmRzdHJlYW0KZW5kb2JqCnhyZWYKMCA1CjAwMDAwMDAwMDAgNjU1MzUgZiAKMDAwMDAwMDAwOSAwMDAwMCBuIAowMDAwMDAwMDU4IDAwMDAwIG4gCjAwMDAwMDAxMTUgMDAwMDAgbiAKMDAwMDAwMDE5NCAwMDAwMCBuIAp0cmFpbGVyCjw8Ci9TaXplIDUKL1Jvb3QgMSAwIFIKPj4Kc3RhcnR4cmVmCjI4OQolJUVPRgo=';\n            document.body.appendChild(link);\n            link.click();\n            document.body.removeChild(link);\n            \n            console.log('Sample hotel: Fake PDF export completed');\n            return true;\n        }\n        \n        let bills = getBillHistory();\n        const user = getCurrentUser();\n        \n        // Apply monthly filter if provided\n        if (monthlyFilter) {\n            const { year, month } = monthlyFilter;\n            bills = bills.filter(bill => {\n                const billDate = new Date(bill.date.split('/').reverse().join('-'));\n                return billDate.getFullYear() === year && billDate.getMonth() === month;\n            });\n        }\n        \n        if (bills.length === 0) {\n            throw new Error('No bills to export');\n        }\n        \n        // Create new PDF document\n        const doc = new jsPDF();\n        \n        // Add header with better styling - removed VK Solutions as requested\n        doc.setFontSize(16);\n        doc.setFont(undefined, 'bold');\n        \n        // Convert hotel name to readable format for PDF\n        const hotelDisplayName = user?.hotelName === 'हॉटेल मातोश्री' ? 'Hotel Matoshree' : \n                               user?.hotelName === 'हॉटेल गुरुकृपा' ? 'Hotel Gurukrupa' : \n                               (user?.hotelName || 'Hotel');\n        doc.text(`${hotelDisplayName} - Bill History`, 20, 20);\n        \n        doc.setFontSize(12);\n        doc.setFont(undefined, 'normal');\n        doc.text(`Export Date: ${new Date().toLocaleDateString()}`, 20, 35);\n        doc.text(`Total Bills: ${bills.length}`, 20, 45);\n        \n        // Generate the bill table\n        generateBillTable(doc, bills, 60);\n        \n        return doc;\n    } catch (error) {\n        console.error('Error generating PDF:', error);\n        throw error;\n    }\n};\n\n// Helper function to generate bill table\nconst generateBillTable = (doc, bills, startYPos) => {\n    let yPos = startYPos;\n    \n    // Add summary table headers - adjusted column positions to fit in page\n    doc.setFont(undefined, 'bold');\n    doc.setFontSize(9);\n    doc.text('Sr.', 15, yPos);\n    doc.text('Bill No.', 25, yPos);\n    doc.text('Date', 55, yPos);\n    doc.text('Customer', 85, yPos);\n    doc.text('Type', 120, yPos);\n    doc.text('Total', 140, yPos);\n    doc.text('Received', 165, yPos);\n    doc.text('Balance', 190, yPos);\n    yPos += 5;\n    \n    // Draw line under headers - adjusted width to fit page\n    doc.line(15, yPos, 210, yPos);\n    yPos += 5;\n    \n    // Add bills summary in table format\n    doc.setFont(undefined, 'normal');\n    doc.setFontSize(8);\n    \n    bills.forEach((bill, index) => {\n        // Check if we need a new page\n        if (yPos > 270) {\n            doc.addPage();\n            yPos = 20;\n            \n            // Repeat headers on new page\n            doc.setFont(undefined, 'bold');\n            doc.setFontSize(9);\n            doc.text('Sr.', 15, yPos);\n            doc.text('Bill No.', 25, yPos);\n            doc.text('Date', 55, yPos);\n            doc.text('Customer', 85, yPos);\n            doc.text('Type', 120, yPos);\n            doc.text('Total', 140, yPos);\n            doc.text('Received', 165, yPos);\n            doc.text('Balance', 190, yPos);\n            yPos += 5;\n            doc.line(15, yPos, 210, yPos);\n            yPos += 5;\n            doc.setFont(undefined, 'normal');\n            doc.setFontSize(8);\n        }\n        \n        const customerName = (bill.customerInfo?.name || 'Walk-in').substring(0, 12);\n        const orderType = (bill.customerInfo?.tableNumber && bill.customerInfo.tableNumber !== '-') ? 'Table' : 'Parcel';\n        const jama = bill.paymentInfo?.jama || 0;\n        const baki = bill.paymentInfo?.baki || bill.total || 0;\n        \n        doc.text((index + 1).toString(), 15, yPos);\n        doc.text(bill.billNumber, 25, yPos);\n        doc.text(bill.date, 55, yPos);\n        doc.text(customerName, 85, yPos);\n        doc.text(orderType, 120, yPos);\n        doc.text(`${(bill.total || 0).toFixed(0)}`, 140, yPos);\n        doc.text(`${jama.toFixed(0)}`, 165, yPos);\n        doc.text(`${baki.toFixed(0)}`, 190, yPos);\n        yPos += 5;\n    });\n    \n    // Add totals at the end\n    yPos += 3;\n    doc.line(140, yPos, 210, yPos);\n    yPos += 5;\n    \n    const totalAmount = bills.reduce((sum, bill) => sum + (bill.total || 0), 0);\n    const totalJama = bills.reduce((sum, bill) => sum + (bill.paymentInfo?.jama || 0), 0);\n    const totalBaki = bills.reduce((sum, bill) => sum + (bill.paymentInfo?.baki || bill.total || 0), 0);\n    \n    doc.setFont(undefined, 'bold');\n    doc.setFontSize(9);\n    doc.text('TOTALS:', 110, yPos);\n    doc.text(`Rs.${totalAmount.toFixed(0)}`, 140, yPos);\n    doc.text(`Rs.${totalJama.toFixed(0)}`, 165, yPos);\n    doc.text(`Rs.${totalBaki.toFixed(0)}`, 190, yPos);\n    \n    return doc;\n};\n\n// Print single bill (for browser print)\nexport const printSingleBill = (bill) => {\n    const user = getCurrentUser();\n    \n    // Create a new window for printing\n    const printWindow = window.open('', '_blank');\n    \n    const printContent = `\n    <!DOCTYPE html>\n    <html>\n    <head>\n        <title>Bill - ${bill.billNumber}</title>\n        <style>\n            body { font-family: Arial, sans-serif; margin: 20px; }\n            .header { text-align: center; margin-bottom: 20px; }\n            .bill-info { margin-bottom: 20px; }\n            .items-table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }\n            .items-table th, .items-table td { border: 1px solid #ddd; padding: 8px; text-align: left; }\n            .items-table th { background-color: #f2f2f2; }\n            .total-section { text-align: right; margin-top: 20px; }\n            .footer { margin-top: 30px; text-align: center; font-size: 12px; color: #666; }\n        </style>\n    </head>\n    <body>\n        <div class=\"header\">\n            <h2>${user?.hotelName || 'Hotel'}</h2>\n            <h3>Bill Receipt - ${bill.billNumber}</h3>\n        </div>\n        \n        <div class=\"bill-info\">\n            <p><strong>Date:</strong> ${bill.date}</p>\n            <p><strong>Time:</strong> ${bill.time}</p>\n            ${bill.customerInfo?.name ? `<p><strong>Customer:</strong> ${bill.customerInfo.name}</p>` : ''}\n        </div>\n        \n        <table class=\"items-table\">\n            <thead>\n                <tr>\n                    <th>Item</th>\n                    <th>Rate</th>\n                    <th>Quantity</th>\n                    <th>Amount</th>\n                </tr>\n            </thead>\n            <tbody>\n                ${bill.items.map(item => `\n                    <tr>\n                        <td>${item.name}</td>\n                        <td>₹${item.rate}</td>\n                        <td>${item.quantity}</td>\n                        <td>₹${(item.rate * item.quantity).toFixed(2)}</td>\n                    </tr>\n                `).join('')}\n            </tbody>\n        </table>\n        \n        <div class=\"total-section\">\n            <p><strong>Subtotal: ₹${(bill.subtotal || 0).toFixed(2)}</strong></p>\n            <p><strong>Tax: ₹${(bill.tax || 0).toFixed(2)}</strong></p>\n            <p><strong>Total: ₹${(bill.total || 0).toFixed(2)}</strong></p>\n            ${bill.paymentInfo ? `\n                <p>Received (Jama): ₹${(bill.paymentInfo.jama || 0).toFixed(2)}</p>\n                <p>Balance (Baki): ₹${(bill.paymentInfo.baki || 0).toFixed(2)}</p>\n            ` : ''}\n        </div>\n        \n        <div class=\"footer\">\n            <p>Thank you for visiting ${user?.hotelName || 'our hotel'}!</p>\n            <p>Powered by VK Solutions Hotel Management System</p>\n        </div>\n    </body>\n    </html>\n    `;\n    \n    printWindow.document.write(printContent);\n    printWindow.document.close();\n    printWindow.print();\n};"],"names":["getBillHistory","hotelId","getCurrentHotelId","console","log","id","billNumber","date","time","customerInfo","name","tableNumber","phoneNumber","items","code","rate","quantity","subtotal","tax","total","paymentInfo","jama","baki","hotelName","savedAt","savedBy","storageKey","concat","bills","localStorage","getItem","parsedBills","JSON","parse","length","autoExportMonthlyReport","today","Date","getDate","lastMonth","getFullYear","getMonth","startDate","toISOString","split","endDate","monthlyBills","filter","bill","billDate","reverse","join","doc","generateMonthlyPDF","monthName","toLocaleString","month","year","fileName","replace","save","user","getCurrentUser","jsPDF","setFontSize","setFont","undefined","hotelDisplayName","monthYear","text","toLocaleDateString","generateBillTable","startYPos","yPos","line","forEach","index","_bill$customerInfo3","_bill$customerInfo4","_bill$paymentInfo3","_bill$paymentInfo4","addPage","customerName","substring","orderType","toString","toFixed","totalAmount","reduce","sum","totalJama","_bill$paymentInfo5","totalBaki","_bill$paymentInfo6"],"sourceRoot":""}